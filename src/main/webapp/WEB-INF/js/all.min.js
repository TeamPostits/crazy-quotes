!function(){var a={services:{},view:{}};a.services=function(){var a,b,c="X-Auth-Token",d="X-Username",e=function(b,d,e){a=g.getResponseHeader(c)},f=function(c,d,e){a=void 0,b=void 0},g=function(a){return $.ajax(a).done(e).fail(f)};return{createAccount:function(a){return g({url:"/user",type:"post",data:{username:a.username,password:a.password},dataType:"json",contentType:"application/json"}).done(function(){b=a.username})},login:function(a){return g({url:"/login",type:"post",data:{username:a.username,password:a.password},dataType:"json",contentType:"application/json"}).done(function(){b=a.username})},addQuote:function(e){var f={};return f[c]=a,f[d]=b,$.ajax({url:"/quotes",type:"post",data:e,headers:f,dataType:"json",contentType:"application/json"})},getAllQuotes:function(){var e={};return e[c]=a,e[d]=b,g({url:"/quotes",type:"get",headers:e,dataType:"json"})}}}(),a.view=function(){var b=function(){$(".quotes").hide(),$("#quotes-list").empty(),$(".login").show()},c=function(){$(".login").hide(),$("#psw").val(""),$(".quotes").fadeIn()},d=function(){$("#login-form").addClass("login-fail"),$(".login-fail-message").show(),$("#psw").val("")},e=function(a){$("#quotes-list").empty();var b,d,e,f,g,h,i,j=$("<span>");for(g=0;g<a.length;g+=1)i=a[g],b=j.text(i.quote)[0].innerHTML,d=j.text(i.author)[0].innerHTML,e=j.text(i.year)[0].innerHTML,f=j.text(i.createdBy)[0].innerHTML,h=$('<li class="card"><span class="quote-text card-header">"'+b+'"</span> <br> <span class="quote-author pull-right">- '+d+", "+e+'</span><br><span class="quote-created-by pull-right">'+f+"</span></li>"),$("#quotes-list").append(h);c()},f=function(){a.services.getAllQuotes().done(function(a){e(a)}).fail(function(){b()})},g=function(a){var b,a=$(this).serializeArray(),c={};for(b=0;b<a.length;b+=1)c[a[b].name]=a[b].value;return c},h=function(b){b.preventDefault();var c=g($(this).serializeArray());$("#new",this).checked?a.services.createAccount(c).done(function(){$(".login-fail-message").hide(),f()}).fail(function(){d()}):a.services.login(c).done(function(){$(".login-fail-message").hide(),f()}).fail(function(){d()})},i=function(c){c.preventDefault();var d=g($(this).serializeArray());a.services.addQuote(d).done(function(){f()}).fail(function(){b()})};$(function(){$("#login-form").submit(h),$("#quote-form").submit(i)})}()}();